# Update File Malware Scanner State

{% swagger expanded="true" fullWidth="true" method="put" path="/v1​/attachments​/malware-scan​/state" baseUrl="https://your-pod-subdomain.symphony.com/maestro/api" summary="Updates the file malware scan state on the pod." %}
{% swagger-description %}
Implemented by Symphony, the API is exposed on the customer's pod. The malware-scanning service should use this API to update the malware scanning state of a given file on the pod. The calling service account should have 'Malware Scan State User' role to make this call.
Allowed values: OK, BAD, UNSCANNABLE, SCAN_ERROR and EXPIRED.

OK - Malware Scan state is ok. The file can be downloaded.
BAD - Malware Scan determined the file to be bad. The file cannot be downloaded.
UNSCANNABLE - Malware Scan cannot be done for the file. The file will not be downloadable. Symphony will treat this equivalent to the 'BAD' state.
EXPIRED - Malware Scan state is too old to be used any more. The file will not be downloadable. The customers can use this state to prevent further downloads of the file. As of now, Symphony doesn't support the TTL functionality. Therefore, Symphony will not be changing an existing 'OK' state to 'EXPIRED'.
{% endswagger-description %}

{% swagger-parameter in="header" name="sessionToken" type="string" required="true" %}
Authentication session token.
{% endswagger-parameter %}

{% swagger-parameter in="header" name="X-Trace-Id" type="string" required="false" %}
Trace ID that shall be returned back in header when updating the malware scan state for the file. This field is not required, being used for debugging purposes only.
{% endswagger-parameter %}

{% swagger-parameter in="query" name="fileId" type="string" required="true" %}
Id of the file whose malware scan state should be updated. It should be URL encoded.
{% endswagger-parameter %}

{% swagger-parameter in="body" name="status" type="string" required="false" %}
Contains the result of scanning and some additional information.
Accepted values: OK, BAD, UNSCANNABLE, SCAN_ERROR and EXPIRED.
{% endswagger-parameter %}

{% swagger-parameter in="body" name="status" type="int32" required="false" %}
TTL timestamp in epoch seconds. After that point in time file shall be re-scanned in case of download attempt. This has not been implemented yet.
{% endswagger-parameter %}

{% swagger-response status="204: No Content" description="Result" %}
```javascript
//Successfully posted, see response body for further information.
```
{% endswagger-response %}

{% swagger-response status="400: Bad Request" description="Result" %}
```javascript
//Bad request, see response body for further details.
```
{% endswagger-response %}

{% swagger-response status="500: Internal Server Error" description="Result" %}
```javascript
//An error occurred while updating a file. See response body for further details.
```
{% endswagger-response %}
{% endswagger %}